# 設計: iOS バックグラウンド検証

## コンテキスト
iOS はバックグラウンド実行を厳しく制限しています。ジオフェンシングには `expo-location` を、定期チェックには `react-native-background-fetch` を使用しています。また、`bluetooth-central` バックグラウンドモードを利用して、特定の条件下でバックグラウンド BLE スキャンを実行します。

## 検証戦略

### 1. 通知による可観測性
バックグラウンドでは UI を確認できないため、**ローカル通知**に依存します。
- **ジオフェンス**: "Entered Area" / "Exited Area"
- **スキャン**: "Background Scan Started" (デバッグ通知)
- **結果**: "Attendance Recorded"

### 2. ログによる可観測性
macOS の `Console.app` で確認できる `console.log` を使用します。
- タグ: `[Geofencing Task]`, `[Periodic Check]`

### 3. テスト計画
以下の理由から、手動テスト計画が必要です：
- シミュレータでは Bluetooth が使用できません。
- バックグラウンド動作（特に位置情報と BLE の連携）は実機でのみ正確に検証可能です。

## トレードオフ
- **通知**: 通知が多すぎると煩わしくなる可能性があります。デバッグ通知は `DEBUG_BLE` 定数または `__DEV__` チェックを使用して制御します。

## 代替案
- **ファイルへのログ出力**: ファイルにログを書き出し、後で共有機能で取り出す。*実装コストが高いため、今回は却下。* Console.app で十分です。
